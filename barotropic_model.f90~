
program barotropic_model
	use, intrinsic :: iso_fortran_env
	use params
	use coeffs, only: get_coeffs, build_lin_op
	use utils, only: time_seed, white_noise
	use barotropic6d, only: run_model
	implicit none
	
	
	!Initialise data structures
	real(dp), dimension(sample_num,dims) :: state_vector
	real(dp), dimension(coeff_num) :: coeff
	real(dp), dimension(dims,dims) :: lin_op
	
	!Seed random numbers
	call time_seed()

	!Generate coefficients and the linear time evolution operator
	call get_coeffs(b,beta,g,coeff)
	call build_lin_op(lin_op,coeff)
	

	print*,"initialisation complete"
	call run_model(init_con,step_num,sample_num,state_vector,coeff,lin_op)
	
	OPEN( 10, FILE=save_file )
	WRITE(10, *) state_vector   
end program
